---
title: "Stat 230 Individual HW 1"
author: "Name: Teagan Johnson"
output: pdf_document
---
```{r, include=FALSE}
knitr::opts_chunk$set(collapse=TRUE, prompt=TRUE, comment=NULL)
```

#### Worked with:


--------------

### Directions
Homework 1 is due **noon, Tuesday 9/21/21**. Please complete the assignment in this Markdown document, filling in your answers and R code below. Submit  a hard copy of the **compiled pdf** either

  - in class on Monday 9/20
  - in drop-in office hours (Tuesday 9/21)
  - in the paper holder outside my CMC 222 office door (hopefully it will be installed by then!)
  
  
Make sure to follow the [homework guidelines](https://kstclair.github.io/stat-230/handouts/homework_guidelines.html) when writing up this assignment.

Tips for using Markdown with homework sets:

- Work through a problem by putting your R code into R chunks in this .Rmd. Run the R code to make sure it works, then knit the .Rmd to verify they work in that environment. 
    - Make sure you load your data in the .Rmd and include any needed `library` commands. 
- Feel free to edit or delete  questions, instructions, or code provided in this file when producing your homework solution. 
- For your final document, you can change the output type from `html_document` to `word_document` or `pdf_document`. These two to output types are better formatted for printing. 
  - on maize: you may need to allow for pop-ups from this site 
- If you want to knit to pdf while running Rstudio from your computer (*not* from maize), you  will need a LaTeX compiler installed on your computer. This could be [MiKTeX](https://miktex.org/), [MacTeX](http://www.tug.org/mactex/) (mac), or TinyTex. The latter is installed in R: first install the R package `tinytex`, then run the command `tinytex::install_tinytex()` to install this software. 
  - If you are using maize, you don't need to install anything to knit to pdf!


## Problem 1
The day 2 handout example compares the average number of farms per county in 1992 in the western and north central regions of the U.S. Your homework problem is to repeat this analysis but compare the southern and north central regions of the U.S. 

```{r}
# data for HW 1
agstrat <- read.csv("http://people.carleton.edu/~kstclair/data/agstrat.csv")
table(agstrat$region)
```


### (a)  Enter the data in R then use the `filter` command to create a data frame that contains only the southern and north central regions.  How many rows are in this new data set? How many counties each in the southern and north central regions? 

*Answer:* There are 238 rows in total. There are 103 counties in the north central region and 135 counties in the south region.
```{r}
library(dplyr)
agstrat2 <- filter(agstrat, region %in% c("NC", "S"))
table(agstrat2$region)
```

### (b)  Use basic EDA tools (summary stats and graph(s)) to compare `farms92` in the southern and north central regions. Make three comparative statements using these stats and graph(s). Please refer to the Notes [Graph Formatting section](https://kstclair.github.io/stat-230-notes/markdown.html#markdown-graphs) to resize your graphs from the large default size.

*Answer:* The distribution of farms by region for both the south and north central regions is skewed right, with the south region having a handful of outliers. Counties in the north central region tend to have more farms than counties in the south. The mean of north central counties is 750.7 while the mean for south counties is 578.6.

```{r, fig.width=9, fig.height=4}
boxplot(farms92 ~ region, data = agstrat2, horizontal=TRUE, main="Number of farms (1992) by region",
        ylab = "region", xlab = "# of farms per county in 1992")
```
```{r}
tapply(agstrat2$farms92, agstrat2$region, summary)
```
```{r, fig.width=9, fig.height=4}
library(ggplot2)  # load ggplot2 package
ggplot(agstrat2, aes(x=farms92)) + 
  geom_histogram() + 
  facet_wrap(~region) + 
  labs(title = "Number of farms by region")
```

### (c) There is one extreme outlier in the southern region. Identify this county by row number and by county name.

*Answer:* Hillsborough County, in FLorida, had 2760 farms in 1992. This is the county with the outlier. It is row 129.

```{r}
which(agstrat2$farms92 > 2700) 
```
```{r}
agstrat2[129,]
```



### (d) Check the inference assumptions. Are the distributions within each region symmetric or skewed? Can you still conduct a t test/CI for this data even if one or both of the distributions are skewed? 

*Answer:* The distributions of both the south and the north central regions are skewed right. The southern region is much more skewed right than the north central region. Because the sample is large enough (103 from north central and 135 from south), you are still able to conduct a t test and confidence interval.

```{r}
southRegion <- subset(agstrat2, region == "S")
nCRegion <- subset(agstrat2, region == "NC")
hist(southRegion$farms92)
hist(nCRegion$farms92)
table(agstrat2$region)
```

### (e) Run the t test needed to test:
$$
H_0: \mu_S = \mu_{NC} \ \ \  H_A: \mu_S \neq \mu_{NC}
$$
where $\mu_r$ is the population mean number of farms per county for all counties within region ``r".  Interpret the t-statistic for this test, then use the p-value to make a conclusion.

*Answer:* The t-statistic is 3.1976. The resulting data was 3.1976 standard deviations away from the mean (expected value). The p-value for this test is 0.001575. This means that given the null hypothesis is true (both regions have equal numbers of farms), there is a 0.001575 chance that we would see a difference as great or greater than the one we observed. Therefore, we have sufficient evidence to reject the null hypothesis.

```{r}
t.test(farms92 ~ region, data = agstrat2)
```

### (f) Repeat part (e) with the outlier identified in part (c) omitted. Does your conclusion change? Explain why or why not.

*Answer:* The t test statistic increases to 3.6576. This means that the observed difference is 3.6576 standard deviations larger than the expected value. The p-value is 0.0003145. This means that given the null hypothesis is true, we have a 0.0003145 chance of getting the observed difference. Our conclusion stays the same, that the results are statistically significant and we can reject the null hypothesis.

```{r}
t.test(farms92 ~ region, subset = -129, data = agstrat2)
```

### (g) Use the confidence interval computed in part (f) to compare the mean number of farms per county within each region. Do not use the work "difference" in your interpretation, instead use directional words like "more" or "less".

*Answer:* Excluding Hillsborough county because of its high number of farms, we are 95% confident that the true difference in the mean number of farms between the south and north central regions is between 86.9073 and 289.8400. We observed that the north central region has on average 188.38 more farms than the southern region. This is statistically significant, and we can conclude that the north central region has more farms per county than the southern region.

```{r}
# (g) code if needed
```
